<Window x:Class="ReportTemplateEditor.Designer.TableDesignerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="表格内容设计器"
        Width="800"
        Height="600"
        WindowStartupLocation="CenterOwner"
        MinWidth="600"
        MinHeight="400">
    <Window.Resources>
        <!-- 按钮样式 -->
        <Style TargetType="Button" x:Key="ActionButtonStyle">
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="5,0,5,0"/>
            <Setter Property="Background" Value="#4A90E2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#357ABD"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- 删除按钮样式 -->
        <Style TargetType="Button" x:Key="DeleteButtonStyle" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="#E74C3C"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#C0392B"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- 单元格样式 -->
        <Style TargetType="Border" x:Key="CellBorderStyle">
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="CornerRadius" Value="0"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="2" ShadowDepth="1" Direction="270"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F0F8FF"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- 选中单元格样式 -->
        <Style TargetType="Border" x:Key="SelectedCellBorderStyle" BasedOn="{StaticResource CellBorderStyle}">
            <Setter Property="Background" Value="#D0E8FF"/>
            <Setter Property="BorderBrush" Value="#4A90E2"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#4A90E2" Opacity="0.3" BlurRadius="4" ShadowDepth="2" Direction="270"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- 表头单元格样式 -->
        <Style TargetType="Border" x:Key="HeaderCellBorderStyle" BasedOn="{StaticResource CellBorderStyle}">
            <Setter Property="Background" Value="#E8E8E8"/>
            <Setter Property="BorderBrush" Value="#666666"/>
            <Setter Property="BorderThickness" Value="1,1,1,2"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="3" ShadowDepth="1.5" Direction="270"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- 表头文本样式 -->
        <Style TargetType="TextBlock" x:Key="HeaderTextStyle">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#333333"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题栏 -->
        <Border Grid.Row="0" Background="#F0F0F0" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="10"/>
        
        <!-- 主要内容区域 -->
        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            
            <!-- 左侧：表格预览和编辑 -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- 行/列操作按钮 -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <Button Content="添加行" Click="AddRow_Click" Style="{StaticResource ActionButtonStyle}"/>
                    <Button Content="删除行" Click="DeleteRow_Click" Style="{StaticResource DeleteButtonStyle}" x:Name="btnDeleteRow" IsEnabled="False"/>
                    <Button Content="添加列" Click="AddColumn_Click" Style="{StaticResource ActionButtonStyle}"/>
                    <Button Content="删除列" Click="DeleteColumn_Click" Style="{StaticResource DeleteButtonStyle}" x:Name="btnDeleteColumn" IsEnabled="False"/>
                </StackPanel>
                
                <!-- 当前选择信息 -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="当前选择：" FontWeight="Bold"/>
                    <TextBlock x:Name="txtSelectionInfo" Text="未选择单元格"/>
                </StackPanel>
                
                <!-- 表格预览区域 -->
                <ScrollViewer Grid.Row="2" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" BorderBrush="#E0E0E0" BorderThickness="1">
                    <Grid x:Name="tablePreviewGrid" Margin="5" HorizontalAlignment="Left" VerticalAlignment="Top">
                        <!-- 表格内容将在这里动态生成 -->
                    </Grid>
                </ScrollViewer>
            </Grid>
            
            <!-- 右侧：单元格属性编辑 -->
            <Grid Grid.Column="1" Margin="10,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="单元格属性" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- 基本属性 -->
                        <GroupBox Header="基本属性" Margin="0,0,0,10">
                            <StackPanel>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="内容：" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="txtCellContent" Margin="5" TextChanged="txtCellContent_TextChanged"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="可编辑：" VerticalAlignment="Center"/>
                                    <CheckBox Grid.Row="1" Grid.Column="1" x:Name="chkIsEditable" Margin="5" Checked="chkIsEditable_Checked" Unchecked="chkIsEditable_Unchecked"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="字体大小：" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Row="2" Grid.Column="1" x:Name="cmbFontSize" Margin="5" SelectionChanged="cmbFontSize_SelectionChanged">
                                        <ComboBoxItem Content="8" Tag="8"/>
                                        <ComboBoxItem Content="9" Tag="9"/>
                                        <ComboBoxItem Content="10" Tag="10"/>
                                        <ComboBoxItem Content="11" Tag="11"/>
                                        <ComboBoxItem Content="12" Tag="12" IsSelected="True"/>
                                        <ComboBoxItem Content="14" Tag="14"/>
                                        <ComboBoxItem Content="16" Tag="16"/>
                                        <ComboBoxItem Content="18" Tag="18"/>
                                        <ComboBoxItem Content="20" Tag="20"/>
                                        <ComboBoxItem Content="24" Tag="24"/>
                                    </ComboBox>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- 文本样式 -->
                        <GroupBox Header="文本样式" Margin="0,0,0,10">
                            <StackPanel>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="字体粗细：" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Row="0" Grid.Column="1" x:Name="cmbFontWeight" Margin="5" SelectionChanged="cmbFontWeight_SelectionChanged">
                                        <ComboBoxItem Content="正常" Tag="Normal" IsSelected="True"/>
                                        <ComboBoxItem Content="粗体" Tag="Bold"/>
                                    </ComboBox>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="文本对齐：" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Row="1" Grid.Column="1" x:Name="cmbTextAlignment" Margin="5" SelectionChanged="cmbTextAlignment_SelectionChanged">
                                        <ComboBoxItem Content="左对齐" Tag="Left" IsSelected="True"/>
                                        <ComboBoxItem Content="居中" Tag="Center"/>
                                        <ComboBoxItem Content="右对齐" Tag="Right"/>
                                    </ComboBox>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="垂直对齐：" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Row="2" Grid.Column="1" x:Name="cmbVerticalAlignment" Margin="5" SelectionChanged="cmbVerticalAlignment_SelectionChanged">
                                        <ComboBoxItem Content="顶部" Tag="Top" IsSelected="True"/>
                                        <ComboBoxItem Content="居中" Tag="Center"/>
                                        <ComboBoxItem Content="底部" Tag="Bottom"/>
                                    </ComboBox>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="文本颜色：" VerticalAlignment="Center"/>
                                    <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="5" VerticalAlignment="Center">
                                        <TextBox x:Name="txtForegroundColor" Text="#000000" Width="80" Margin="0,0,5,0" TextChanged="txtForegroundColor_TextChanged"/>
                                        <Button Content="..." Width="25" Click="btnForegroundColor_Click"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- 背景样式 -->
                        <GroupBox Header="背景样式">
                            <StackPanel>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="背景颜色：" VerticalAlignment="Center"/>
                                    <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="5" VerticalAlignment="Center">
                                        <TextBox x:Name="txtBackgroundColor" Text="#FFFFFF" Width="80" Margin="0,0,5,0" TextChanged="txtBackgroundColor_TextChanged"/>
                                        <Button Content="..." Width="25" Click="btnBackgroundColor_Click"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- 列类型配置 -->
                        <GroupBox Header="列类型配置" Margin="0,10,0,0">
                            <StackPanel>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="列类型：" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Row="0" Grid.Column="1" x:Name="cmbColumnType" Margin="5" SelectionChanged="cmbColumnType_SelectionChanged">
                                        <ComboBoxItem Content="文本输入框" Tag="TextBox" IsSelected="True"/>
                                        <ComboBoxItem Content="下拉选择框" Tag="ComboBox"/>
                                        <ComboBoxItem Content="复选框" Tag="CheckBox"/>
                                        <ComboBoxItem Content="日期选择器" Tag="DatePicker"/>
                                    </ComboBox>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="可编辑：" VerticalAlignment="Center"/>
                                    <CheckBox Grid.Row="1" Grid.Column="1" x:Name="chkColumnEditable" Margin="5" Checked="chkColumnEditable_Checked" Unchecked="chkColumnEditable_Unchecked"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="默认值：" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" x:Name="txtDefaultValue" Margin="5" TextChanged="txtDefaultValue_TextChanged"/>
                                </Grid>
                                
                                <!-- 下拉选项配置 -->
                                <StackPanel Margin="5" Visibility="Collapsed" x:Name="dropdownOptionsPanel">
                                    <TextBlock Text="下拉选项：" FontWeight="Medium" Margin="0,5,0,0"/>
                                    <Grid Margin="0,5,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="txtNewOption" Grid.Column="0" Margin="0,0,5,0"/>
                                        <Button x:Name="btnAddOption" Grid.Column="1" Content="添加" Margin="0,0,5,0" Click="btnAddOption_Click"/>
                                        <Button x:Name="btnRemoveOption" Grid.Column="2" Content="删除" Click="btnRemoveOption_Click"/>
                                    </Grid>
                                    <ListBox x:Name="lstDropdownOptions" Margin="0,5,0,0" Height="100" SelectionMode="Single"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- 列宽配置 -->
                        <GroupBox Header="列宽设置" Margin="0,10,0,0">
                            <StackPanel>
                                <TextBlock Text="选择列：" FontWeight="Medium" Margin="0,5,0,0"/>
                                <ComboBox x:Name="cmbColumnIndex" Margin="5" SelectionChanged="cmbColumnIndex_SelectionChanged"/>
                                
                                <TextBlock Text="列宽（毫米）：" FontWeight="Medium" Margin="0,10,0,0"/>
                                <Grid Margin="0,5,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="txtColumnWidth" Grid.Column="0" Margin="0,0,5,0" TextChanged="txtColumnWidth_TextChanged"/>
                                    <Button x:Name="btnApplyColumnWidth" Grid.Column="1" Content="应用" Click="btnApplyColumnWidth_Click"/>
                                </Grid>
                                
                                <TextBlock Text="提示：拖拽列边缘可快速调整列宽" Foreground="#666666" FontStyle="Italic" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
        
        <!-- 底部按钮栏 -->
        <Border Grid.Row="2" Background="#F5F5F5" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0" Padding="10">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="确定" Click="OkButton_Click" Style="{StaticResource ActionButtonStyle}"/>
                <Button Content="取消" Click="CancelButton_Click" Style="{StaticResource ActionButtonStyle}"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>