<UserControl x:Class="ReportTemplateEditor.Designer.Controls.DataPathSelector" 
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ReportTemplateEditor.Designer.Controls"
             mc:Ignorable="d"
             Width="300"
             Height="400"
             d:DesignHeight="400"
             d:DesignWidth="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 搜索框 -->
        <Border Grid.Row="0" Background="#F0F0F0" Padding="5">
            <DockPanel>
                <TextBox x:Name="searchTextBox" DockPanel.Dock="Left" Width="250" Height="25" 
                         Margin="0,0,5,0" VerticalContentAlignment="Center" 
                         ToolTip="搜索数据路径..." />
                <Button x:Name="searchButton" Content="搜索" Height="25" Width="40" 
                        Click="searchButton_Click" />
            </DockPanel>
        </Border>

        <!-- 数据路径树 -->
        <TreeView x:Name="pathTreeView" Grid.Row="1" Margin="5" 
                  SelectedItemChanged="pathTreeView_SelectedItemChanged">
            <TreeView.Resources>
                <HierarchicalDataTemplate x:Key="DataPathItemTemplate" ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Horizontal">
                        <Image x:Name="itemIcon" Width="16" Height="16" Margin="0,0,5,0" />
                        <TextBlock Text="{Binding DisplayName}" 
                                   FontWeight="{Binding FontWeight}" 
                                   Foreground="{Binding Foreground}" />
                    </StackPanel>
                    </HierarchicalDataTemplate>

                <!-- 图标资源 -->
                <DrawingImage x:Key="CollectionIcon">
                    <DrawingImage.Drawing>
                        <GeometryDrawing Brush="#007ACC" Geometry="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V5H19V19M10,9H7V11H10V9M14,9H11V11H14V9M18,9H15V11H18V9M10,13H7V15H10V13M14,13H11V15H14V13M18,13H15V15H18V13Z"/>
                    </DrawingImage.Drawing>
                </DrawingImage>

                <DrawingImage x:Key="ObjectIcon">
                    <DrawingImage.Drawing>
                        <GeometryDrawing Brush="#4CAF50" Geometry="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                    </DrawingImage.Drawing>
                </DrawingImage>

                <DrawingImage x:Key="PropertyIcon">
                    <DrawingImage.Drawing>
                        <GeometryDrawing Brush="#FF9800" Geometry="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V5H19V19M12,17L8,13H11V7H13V13H16L12,17Z"/>
                    </DrawingImage.Drawing>
                </DrawingImage>
            </TreeView.Resources>
        </TreeView>

        <!-- 操作按钮 -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="5,0,5,5">
            <Button x:Name="okButton" Content="确定" Width="75" Height="25" IsDefault="True" 
                    Click="okButton_Click" Margin="0,0,5,0"/>
            <Button x:Name="cancelButton" Content="取消" Width="75" Height="25" IsCancel="True" 
                    Click="cancelButton_Click" />
        </StackPanel>
    </Grid>
</UserControl>