<Window x:Class="ReportTemplateEditor.Designer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ReportTemplateEditor.Designer"
        xmlns:viewmodels="clr-namespace:ReportTemplateEditor.Designer.ViewModels"
        xmlns:converters="clr-namespace:ReportTemplateEditor.Designer.Converters"
        mc:Ignorable="d"
        Title="报告模板编辑器"
        Height="800"
        Width="1200"
        WindowStartupLocation="CenterScreen"
        PreviewKeyDown="MainWindow_PreviewKeyDown">
    <Window.DataContext>
        <viewmodels:MainWindowViewModel/>
    </Window.DataContext>
    <Window.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:ColorToBrushConverter x:Key="ColorToBrushConverter"/>
        <converters:BooleanInverseConverter x:Key="InverseBooleanConverter"/>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
        <!-- 纸张阴影效果 -->
        <DropShadowEffect x:Key="PaperShadow" Color="#888888" Direction="270" ShadowDepth="5" BlurRadius="10" Opacity="0.3"/>
        
        <!-- 打印纸纹理画笔 -->
        <VisualBrush x:Key="PaperTextureBrush" TileMode="Tile" Viewport="0,0,20,20" ViewportUnits="Absolute" Viewbox="0,0,20,20" ViewboxUnits="Absolute">
            <VisualBrush.Visual>
                <Grid Width="20" Height="20" Background="#FFFFFF">
                    <!-- 轻微的纹理效果 -->
                    <Path Stroke="#F0F0F0" StrokeThickness="0.5">
                        <Path.Data>
                            <GeometryGroup>
                                <LineGeometry StartPoint="0,0" EndPoint="20,20"/>
                                <LineGeometry StartPoint="0,5" EndPoint="20,25"/>
                                <LineGeometry StartPoint="0,10" EndPoint="20,30"/>
                                <LineGeometry StartPoint="0,15" EndPoint="20,35"/>
                                <LineGeometry StartPoint="-5,0" EndPoint="15,20"/>
                                <LineGeometry StartPoint="-10,0" EndPoint="10,20"/>
                                <LineGeometry StartPoint="5,0" EndPoint="25,20"/>
                                <LineGeometry StartPoint="10,0" EndPoint="30,20"/>
                            </GeometryGroup>
                        </Path.Data>
                    </Path>
                </Grid>
            </VisualBrush.Visual>
        </VisualBrush>
        
        <!-- 设计画布背景画笔 - 结合网格和纸张纹理 -->
        <DrawingBrush x:Key="DesignCanvasBackground" TileMode="Tile" Viewport="0,0,10,10" ViewportUnits="Absolute" Viewbox="0,0,10,10" ViewboxUnits="Absolute">
            <DrawingBrush.Drawing>
                <DrawingGroup>
                    <!-- 纸张纹理背景 -->
                    <GeometryDrawing Brush="{StaticResource PaperTextureBrush}">
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,0,10,10"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <!-- 网格线 -->
                    <GeometryDrawing Brush="#EEEEEE" Geometry="M0,10 L10,10 M10,0 L10,10"/>
                </DrawingGroup>
            </DrawingBrush.Drawing>
        </DrawingBrush>
        
        <!-- 工具箱项样式 -->
        <Style TargetType="ListBoxItem" x:Key="ToolboxItemStyle">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#D0E8FF"/>
                    <Setter Property="BorderBrush" Value="#4A90E2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- 属性面板分组样式 -->
        <Style TargetType="Expander" x:Key="PropertyGroupStyle">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,5,0,0"/>
        </Style>
        
        <!-- 表格控件上下文菜单 -->
        <ContextMenu x:Key="TableContextMenu">
            <MenuItem Header="设计表格内容" Click="DesignTableContent_Click"/>
        </ContextMenu>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <!-- 菜单栏 -->
        <Menu Grid.Row="0" Background="#F0F0F0">
            <MenuItem Header="文件">
                <MenuItem Header="新建模板" Command="{Binding NewTemplateCommand}"/>
                <MenuItem Header="打开模板" Command="{Binding OpenTemplateCommand}"/>
                <MenuItem Header="保存模板" Command="{Binding SaveTemplateCommand}"/>
                <MenuItem Header="保存模板为" Command="{Binding SaveAsTemplateCommand}"/>
                <Separator/>
                <MenuItem Header="退出" Command="{Binding ExitCommand}"/>
            </MenuItem>
            <MenuItem Header="编辑">
                <MenuItem Header="撤销" Command="{Binding UndoCommand}"/>
                <MenuItem Header="重做" Command="{Binding RedoCommand}"/>
                <Separator/>
                <!-- 剪切/复制/粘贴/删除功能待实现 -->
                <!-- <MenuItem Header="剪切" Click="Cut_Click"/>
                <MenuItem Header="复制" Click="Copy_Click"/>
                <MenuItem Header="粘贴" Click="Paste_Click"/>
                <MenuItem Header="删除" Click="Delete_Click"/> -->
            </MenuItem>
            <MenuItem Header="视图">
                <MenuItem Header="显示网格" IsCheckable="True" IsChecked="{Binding ShowGrid}" Command="{Binding ToggleShowGridCommand}"/>
                <MenuItem Header="对齐到网格" IsCheckable="True" IsChecked="{Binding SnapToGrid}" Command="{Binding ToggleSnapToGridCommand}"/>
                <Separator/>
                <MenuItem Header="缩放">
                    <MenuItem Header="50%" Command="{Binding ZoomTo50Command}"/>
                    <MenuItem Header="75%" Command="{Binding ZoomTo75Command}"/>
                    <MenuItem Header="100%" Command="{Binding ZoomTo100Command}"/>
                    <MenuItem Header="150%" Command="{Binding ZoomTo150Command}"/>
                    <MenuItem Header="200%" Command="{Binding ZoomTo200Command}"/>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="工具">
                <MenuItem Header="模板属性" Command="{Binding TemplatePropertiesCommand}"/>
                <MenuItem Header="预览模板" Command="{Binding PreviewTemplateCommand}"/>
                <MenuItem Header="导出为JSON" Command="{Binding ExportToJsonCommand}"/>
            </MenuItem>
        </Menu>
        
        <!-- 工具栏 -->
        <Border Grid.Row="1" BorderThickness="0,1,0,1" BorderBrush="#E0E0E0">
            <ToolBar Background="#F0F0F0">
                <Button Content="新建" Command="{Binding NewTemplateCommand}" ToolTip="新建模板"/>
                <Button Content="打开" Command="{Binding OpenTemplateCommand}" ToolTip="打开模板"/>
                <Button Content="保存" Command="{Binding SaveTemplateCommand}" ToolTip="保存模板"/>
                <Separator/>
                <Button Content="撤销" Command="{Binding UndoCommand}" ToolTip="撤销"/>
                <Button Content="重做" Command="{Binding RedoCommand}" ToolTip="重做"/>
                <Separator/>
                <!-- 纸张设置 -->
                <TextBlock Text="纸张: " Margin="0,0,5,0" VerticalAlignment="Center"/>
                <ComboBox x:Name="paperSizeComboBox" Width="60" VerticalAlignment="Center" SelectedValue="{Binding PaperSize}">
                    <ComboBoxItem Content="A3" Tag="A3"/>
                    <ComboBoxItem Content="A4" Tag="A4" IsSelected="True"/>
                    <ComboBoxItem Content="A5" Tag="A5"/>
                    <ComboBoxItem Content="Letter" Tag="Letter"/>
                    <ComboBoxItem Content="Legal" Tag="Legal"/>
                    <ComboBoxItem Content="自定义" Tag="Custom"/>
                </ComboBox>
                <TextBox x:Name="txtCustomWidth" Width="50" Margin="5,0,0,0" ToolTip="自定义宽度（毫米）" Visibility="Collapsed"/>
                <TextBlock Text="×" Margin="0,0,5,0" VerticalAlignment="Center" Visibility="Collapsed" x:Name="customSizeSeparator"/>
                <TextBox x:Name="txtCustomHeight" Width="50" Margin="0,0,5,0" ToolTip="自定义高度（毫米）" Visibility="Collapsed"/>
                <TextBlock Text="边距:" Margin="10,0,5,0" VerticalAlignment="Center"/>
                <TextBox x:Name="txtMargin" Width="60" Text="{Binding Margin}" ToolTip="页边距（毫米）"/>
                <ToggleButton x:Name="orientationToggle" Content="纵向" ToolTip="切换页面方向" Margin="5,0,0,0" IsChecked="{Binding IsLandscape}"/>
                <Separator/>
                <!-- 全局字体设置 -->
                <TextBlock Text="全局字体:" Margin="10,0,5,0" VerticalAlignment="Center"/>
                <TextBox x:Name="txtGlobalFontSize" Width="50" Text="{Binding GlobalFontSize}" ToolTip="全局字体大小（毫米）"/>
                <CheckBox x:Name="chkEnableGlobalFontSize" Content="启用" ToolTip="启用全局字体设置" Margin="5,0,0,0" IsChecked="{Binding EnableGlobalFontSize}"/>
                <Separator/>
                <Button Content="预览" Command="{Binding PreviewTemplateCommand}" ToolTip="预览模板"/>
                <Button Content="导出" Command="{Binding ExportJsonCommand}" ToolTip="导出为JSON"/>
            </ToolBar>
        </Border>
        
        <!-- 主内容区域 -->
        <Grid Grid.Row="2">
            <!-- 左侧工具箱 -->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- 分隔线 -->
            <Border Grid.Column="1" Background="#E0E0E0"/>
            <Border Grid.Column="3" Background="#E0E0E0"/>
            
            <!-- 工具箱 -->
            <Grid Grid.Column="0" Background="#FAFAFA">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="工具箱" FontWeight="Bold" Padding="10" Background="#F0F0F0"/>
                
                <ListBox Grid.Row="1" Margin="5" x:Name="toolboxList" 
                         ItemContainerStyle="{StaticResource ToolboxItemStyle}" 
                         PreviewMouseLeftButtonDown="ToolboxItem_PreviewMouseLeftButtonDown">
                    <ListBoxItem Tag="Text">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="T" FontWeight="Bold" FontSize="16" Margin="0,0,5,0"/>
                            <TextBlock Text="文本"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="Label">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="L" FontWeight="Bold" FontSize="16" Margin="0,0,5,0"/>
                            <TextBlock Text="标签"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="Image">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="16" Height="16" Stroke="#000000" StrokeThickness="1" Fill="#F0F0F0" Margin="0,0,5,0"/>
                            <TextBlock Text="图片"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="Table">
                        <StackPanel Orientation="Horizontal">
                            <Grid Width="16" Height="16" Margin="0,0,5,0">
                                <Line X1="0" Y1="0" X2="16" Y2="0" Stroke="#000000" StrokeThickness="1"/>
                                <Line X1="0" Y1="8" X2="16" Y2="8" Stroke="#000000" StrokeThickness="1"/>
                                <Line X1="0" Y1="16" X2="16" Y2="16" Stroke="#000000" StrokeThickness="1"/>
                                <Line X1="0" Y1="0" X2="0" Y2="16" Stroke="#000000" StrokeThickness="1"/>
                                <Line X1="8" Y1="0" X2="8" Y2="16" Stroke="#000000" StrokeThickness="1"/>
                                <Line X1="16" Y1="0" X2="16" Y2="16" Stroke="#000000" StrokeThickness="1"/>
                            </Grid>
                            <TextBlock Text="表格"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="LabelInputBox">
                        <StackPanel Orientation="Horizontal">
                            <Grid Width="16" Height="16" Margin="0,0,5,0">
                                <TextBlock Text="L" FontWeight="Bold" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                            <TextBlock Text="标签输入框"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="Line">
                        <StackPanel Orientation="Horizontal">
                            <Line X1="0" Y1="8" X2="16" Y2="8" Stroke="#000000" StrokeThickness="2" Margin="0,0,5,0"/>
                            <TextBlock Text="线条"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="Rectangle">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="16" Height="16" Stroke="#000000" StrokeThickness="1" Fill="Transparent" Margin="0,0,5,0"/>
                            <TextBlock Text="矩形"/>
                        </StackPanel>
                    </ListBoxItem>
                    <ListBoxItem Tag="Ellipse">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="16" Height="16" Stroke="#000000" StrokeThickness="1" Fill="Transparent" Margin="0,0,5,0"/>
                            <TextBlock Text="椭圆"/>
                        </StackPanel>
                    </ListBoxItem>
                </ListBox>
            </Grid>
            
            <!-- 设计画布 -->
            <Grid Grid.Column="2" Background="#FFFFFF">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- 画布标题 -->
                <Border Grid.Row="0" Padding="10" Background="#F5F5F5">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock x:Name="canvasTitleText" Text="{Binding CanvasTitle}" FontWeight="Bold"/>
                        <TextBlock Text=" | " Margin="5,0,0,0" Foreground="#666666"/>
                        <TextBlock x:Name="pageMarginsText" Text="{Binding PageMarginsText}" Foreground="#666666" Margin="0,0,10,0"/>
                        <Button Content="实际尺寸" Command="{Binding ResetZoomCommand}" Margin="0,0,5,0" Padding="5,2" Background="#E8F4FF" BorderBrush="#4A90E2" Foreground="#2C5AA0" FontWeight="Medium"/>
                        <TextBlock x:Name="zoomText" Text="{Binding ZoomLevelText}" Margin="0,0,5,0" Foreground="#666666" Width="40"/>
                        <Slider x:Name="zoomSlider" Minimum="10" Maximum="500" Value="{Binding ZoomLevel}" Width="150" VerticalAlignment="Center"/>
                        <TextBlock x:Name="statusTextBlock" Text="{Binding Status}" Foreground="#666666" Margin="10,0,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- 画布滚动视图 -->
                <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Background="#E8E8E8">
                    <Viewbox x:Name="designViewbox" Stretch="Uniform" UseLayoutRounding="True" SnapsToDevicePixels="True">
                        <Grid>
                            <!-- 打印纸背景 -->
                            <Border Background="#FFFFFF" BorderBrush="#E0E0E0" BorderThickness="1" Effect="{StaticResource PaperShadow}">
                                <Canvas x:Name="designCanvas" Width="210" Height="297" Background="Transparent" 
                                        AllowDrop="True" Drop="DesignCanvas_Drop" 
                                        DragOver="DesignCanvas_DragOver" 
                                        PreviewMouseLeftButtonDown="DesignCanvas_PreviewMouseLeftButtonDown" 
                                        PreviewMouseRightButtonDown="DesignCanvas_PreviewMouseRightButtonDown"
                                        PreviewMouseRightButtonUp="DesignCanvas_PreviewMouseRightButtonUp"
                                        PreviewMouseMove="DesignCanvas_PreviewMouseMove" 
                                        PreviewMouseLeftButtonUp="DesignCanvas_PreviewMouseLeftButtonUp"
                                        PreviewMouseWheel="designCanvas_PreviewMouseWheel">
                                    <!-- 网格背景 -->
                                    <Canvas x:Name="gridCanvas" Width="210" Height="297" IsHitTestVisible="False" Background="Transparent">
                                    </Canvas>
                                    
                                    <!-- 页边距显示 - 上下左右四个边距区域 -->
                                    <Border x:Name="leftMargin" Background="#F5F5F5" Canvas.ZIndex="0" Visibility="Visible" />
                                    <Border x:Name="topMargin" Background="#F5F5F5" Canvas.ZIndex="0" Visibility="Visible" />
                                    <Border x:Name="rightMargin" Background="#F5F5F5" Canvas.ZIndex="0" Visibility="Visible" />
                                    <Border x:Name="bottomMargin" Background="#F5F5F5" Canvas.ZIndex="0" Visibility="Visible" />
                                    
                                    <!-- 模板元素将动态添加到这里 -->
                                </Canvas>
                            </Border>
                        </Grid>
                    </Viewbox>
                </ScrollViewer>
            </Grid>
            
            <!-- 右侧面板：图层管理 + 属性面板 -->
            <Grid Grid.Column="4" Background="#FAFAFA">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="5"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- 图层管理面板 -->
                <Grid Grid.Row="0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- 图层管理标题 -->
                    <Border Grid.Row="0" Background="#4A90E2" Padding="12" CornerRadius="4,4,0,0">
                        <TextBlock Text="图层管理" FontWeight="Bold" Foreground="#FFFFFF" FontSize="14"/>
                    </Border>
                    
                    <!-- 图层列表 -->
                    <Border Grid.Row="1" Background="#FFFFFF" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="0,0,4,4">
                        <DockPanel Margin="5">
                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,5">
                                <Button Content="上移" Command="{Binding MoveLayerUpCommand}" ToolTip="将选中元素上移一层" Margin="0,0,5,0" 
                                        Background="#F0F4F8" BorderBrush="#C7D2E0" Foreground="#2C5AA0" 
                                        Padding="8,4" FontWeight="Medium"/>
                                <Button Content="下移" Command="{Binding MoveLayerDownCommand}" ToolTip="将选中元素下移一层" Margin="0,0,5,0" 
                                        Background="#F0F4F8" BorderBrush="#C7D2E0" Foreground="#2C5AA0" 
                                        Padding="8,4" FontWeight="Medium"/>
                                <Button Content="置顶" Command="{Binding BringToFrontCommand}" ToolTip="将选中元素置于顶层" Margin="0,0,5,0" 
                                        Background="#F0F4F8" BorderBrush="#C7D2E0" Foreground="#2C5AA0" 
                                        Padding="8,4" FontWeight="Medium"/>
                                <Button Content="置底" Command="{Binding SendToBackCommand}" ToolTip="将选中元素置于底层" 
                                        Background="#F0F4F8" BorderBrush="#C7D2E0" Foreground="#2C5AA0" 
                                        Padding="8,4" FontWeight="Medium"/>
                            </StackPanel>
                            <ListBox x:Name="layerList" ItemsSource="{Binding LayerWrappers}" SelectionMode="Extended" SelectionChanged="layerList_SelectionChanged"
                                     Background="#FFFFFF" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Margin="2" Padding="8" CornerRadius="3"
                                                Background="#F8F9FA"
                                                BorderBrush="#E0E0E0"
                                                BorderThickness="1">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding ModelElement.Type}" Margin="0,0,10,0" FontWeight="Medium"/>
                                                <TextBlock Text="({Binding ModelElement.X:F1}, {Binding ModelElement.Y:F1})" FontSize="12" Foreground="#666666"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </DockPanel>
                    </Border>
                </Grid>
                
                <!-- 分隔线 -->
                <GridSplitter Grid.Row="1" Height="5" Background="#E0E0E0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" ResizeDirection="Rows"/>
                
                <!-- 属性和预览面板 -->
                <Grid Grid.Row="2" Margin="0,5,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- 属性面板标题 -->
                    <Border Grid.Row="0" Background="#4A90E2" Padding="12" CornerRadius="4,4,0,0">
                        <TextBlock Text="属性" FontWeight="Bold" Foreground="#FFFFFF" FontSize="14"/>
                    </Border>
                    
                    <TabControl Grid.Row="1" x:Name="propertyPanel" Background="#FFFFFF" BorderBrush="#E0E0E0" BorderThickness="1" TabStripPlacement="Top">
                        <TabItem Header="属性">
                            <TabItem.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" Padding="12,6" FontWeight="Medium"/>
                                </DataTemplate>
                            </TabItem.HeaderTemplate>
                            <ScrollViewer Margin="5">
                                <StackPanel>
                                    <!-- 选择信息 -->
                                    <TextBlock x:Name="selectionInfoText" Text="{Binding SelectionInfo}" Foreground="#666666" Margin="0,0,0,10"/>
                                    
                                    <!-- 位置和大小属性 -->
                                    <Expander Header="位置和大小" Style="{StaticResource PropertyGroupStyle}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="X:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                            <TextBox Grid.Row="0" Grid.Column="1" Margin="5" Text="{Binding SelectedElementX}" x:Name="posXTextBox" IsEnabled="{Binding HasSelectedElement}" 
                                                     Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                                     Padding="8" FontWeight="Medium"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Y:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" Margin="5" Text="{Binding SelectedElementY}" x:Name="posYTextBox" IsEnabled="{Binding HasSelectedElement}" 
                                                     Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                                     Padding="8" FontWeight="Medium"/>
                                            
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="宽度:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                            <TextBox Grid.Row="2" Grid.Column="1" Margin="5" Text="{Binding SelectedElementWidth}" x:Name="widthTextBox" IsEnabled="{Binding HasSelectedElement}" 
                                                     Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                                     Padding="8" FontWeight="Medium"/>
                                            
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="高度:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                            <TextBox Grid.Row="3" Grid.Column="1" Margin="5" Text="{Binding SelectedElementHeight}" x:Name="heightTextBox" IsEnabled="{Binding HasSelectedElement}" 
                                                     Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                                     Padding="8" FontWeight="Medium"/>

                                            <!-- 全局字体设置 -->
                                            <CheckBox x:Name="chkIgnoreGlobalFontSize" Content="忽略全局字体设置" Margin="0,10,0,0" IsChecked="{Binding IgnoreGlobalFontSize}"/>

                                        </Grid>
                                        
                                    </Expander>
                                    
                                    <!-- 外观属性 -->
                                    <Expander Header="外观" Style="{StaticResource PropertyGroupStyle}">
                                        <StackPanel>
                                            <!-- 基本外观 -->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="可见:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                                <CheckBox Grid.Row="0" Grid.Column="1" Margin="5" IsChecked="{Binding SelectedElementVisible}" x:Name="visibleCheckBox" IsEnabled="{Binding HasSelectedElement}" 
                                                          Foreground="#333333" FontWeight="Medium"/>
                                                
                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="旋转:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                                <TextBox Grid.Row="1" Grid.Column="1" Margin="5" Text="{Binding SelectedElementRotation}" x:Name="rotationTextBox" IsEnabled="{Binding HasSelectedElement}" 
                                                         Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                                         Padding="8" FontWeight="Medium"/>
                                                
                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Z轴顺序:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                                <TextBox Grid.Row="2" Grid.Column="1" Margin="5" Text="{Binding SelectedElementZIndex}" x:Name="zIndexTextBox" IsEnabled="{Binding HasSelectedElement}" 
                                                         Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                                         Padding="8" FontWeight="Medium"/>
                                                
                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="不透明度:" Margin="5,5,0,5" FontWeight="Medium" Foreground="#333333"/>
                                                <Slider Grid.Row="3" Grid.Column="1" Margin="5" Minimum="0" Maximum="1" Value="{Binding SelectedElementOpacity}" x:Name="opacitySlider" IsEnabled="{Binding HasSelectedElement}" 
                                                        Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="1"/>
                                            </Grid>
                                            
                                            <!-- 背景和边框 -->
                                            <Border BorderThickness="0,1,0,0" BorderBrush="#E0E0E0" Margin="0,10,0,0"/>
                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="背景颜色:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Margin="5" Text="{Binding SelectedElementBackgroundColor}" x:Name="backgroundColorTextBox" IsEnabled="{Binding HasSelectedElement}"/>
                                                
                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="边框颜色:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="1" Grid.Column="1" Margin="5" Text="{Binding SelectedElementBorderColor}" x:Name="borderColorTextBox" IsEnabled="{Binding HasSelectedElement}"/>
                                                
                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="边框宽度:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="2" Grid.Column="1" Margin="5" Text="{Binding SelectedElementBorderWidth}" x:Name="borderWidthTextBox" IsEnabled="{Binding HasSelectedElement}"/>
                                                
                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="边框样式:" Margin="5,5,0,5"/>
                                                <ComboBox Grid.Row="3" Grid.Column="1" Margin="5" x:Name="borderStyleComboBox" IsEnabled="{Binding HasSelectedElement}" SelectedValue="{Binding SelectedElementBorderStyle}">
                                                    <ComboBoxItem Content="Solid" Tag="Solid" IsSelected="True"/>
                                                    <ComboBoxItem Content="Dashed" Tag="Dashed"/>
                                                    <ComboBoxItem Content="Dotted" Tag="Dotted"/>
                                                </ComboBox>
                                                
                                                <TextBlock Grid.Row="4" Grid.Column="0" Text="圆角半径:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="4" Grid.Column="1" Margin="5" Text="{Binding SelectedElementCornerRadius}" x:Name="cornerRadiusTextBox" IsEnabled="{Binding HasSelectedElement}"/>
                                            </Grid>
                                            
                                            <!-- 阴影效果 -->
                                            <Border BorderThickness="0,1,0,0" BorderBrush="#E0E0E0" Margin="0,10,0,0"/>
                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="阴影颜色:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Margin="5" Text="{Binding SelectedElementShadowColor}" x:Name="shadowColorTextBox" IsEnabled="{Binding HasSelectedElement}"/>
                                                
                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="阴影深度:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="1" Grid.Column="1" Margin="5" Text="{Binding SelectedElementShadowDepth}" x:Name="shadowDepthTextBox" IsEnabled="{Binding HasSelectedElement}"/>
                                            </Grid>
                                        </StackPanel>
                                    </Expander>
                                    
                                    <!-- 文本属性 -->
                                    <Expander Header="文本" Style="{StaticResource PropertyGroupStyle}">
                                        <StackPanel>
                                            <!-- 基本文本属性 -->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="内容:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="0" Grid.Column="1" Margin="5" x:Name="textContentTextBox" IsEnabled="{Binding HasSelectedElement}" Text="{Binding SelectedElementText}"/>
                                                
                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="字体:" Margin="5,5,0,5"/>
                                                <ComboBox Grid.Row="1" Grid.Column="1" Margin="5" x:Name="fontFamilyComboBox" IsEnabled="{Binding HasSelectedElement}" SelectedValue="{Binding SelectedElementFontFamily}">
                                                    <ComboBoxItem Content="Microsoft YaHei" Tag="Microsoft YaHei"/>
                                                    <ComboBoxItem Content="SimSun" Tag="SimSun"/>
                                                    <ComboBoxItem Content="SimHei" Tag="SimHei"/>
                                                    <ComboBoxItem Content="Arial" Tag="Arial"/>
                                                    <ComboBoxItem Content="Times New Roman" Tag="Times New Roman"/>
                                                </ComboBox>
                                                
                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="大小:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="2" Grid.Column="1" Margin="5" x:Name="fontSizeTextBox" IsEnabled="{Binding HasSelectedElement}" Text="{Binding SelectedElementFontSize}"/>
                                                
                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="粗细:" Margin="5,5,0,5"/>
                                                <ComboBox Grid.Row="3" Grid.Column="1" Margin="5" x:Name="fontWeightComboBox" IsEnabled="{Binding HasSelectedElement}" SelectedValue="{Binding SelectedElementFontWeight}">
                                                    <ComboBoxItem Content="Normal" Tag="Normal"/>
                                                    <ComboBoxItem Content="Bold" Tag="Bold"/>
                                                </ComboBox>
                                                
                                                <TextBlock Grid.Row="4" Grid.Column="0" Text="样式:" Margin="5,5,0,5"/>
                                                <ComboBox Grid.Row="4" Grid.Column="1" Margin="5" x:Name="fontStyleComboBox" IsEnabled="{Binding HasSelectedElement}" SelectedValue="{Binding SelectedElementFontStyle}">
                                                    <ComboBoxItem Content="Normal" Tag="Normal"/>
                                                    <ComboBoxItem Content="Italic" Tag="Italic"/>
                                                </ComboBox>
                                            </Grid>
                                            
                                            <!-- 文本对齐和颜色属性 -->
                                            <Border BorderThickness="0,1,0,0" BorderBrush="#E0E0E0" Margin="0,10,0,0"/>
                                            <Grid Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="文本对齐:" Margin="5,5,0,5"/>
                                                <ComboBox Grid.Row="0" Grid.Column="1" Margin="5" x:Name="textAlignmentComboBox" IsEnabled="{Binding HasSelectedElement}" SelectedValue="{Binding SelectedElementTextAlignment}">
                                                    <ComboBoxItem Content="左对齐" Tag="Left"/>
                                                    <ComboBoxItem Content="居中" Tag="Center"/>
                                                    <ComboBoxItem Content="右对齐" Tag="Right"/>
                                                    <ComboBoxItem Content="两端对齐" Tag="Justify"/>
                                                </ComboBox>
                                                
                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="垂直对齐:" Margin="5,5,0,5"/>
                                                <ComboBox Grid.Row="1" Grid.Column="1" Margin="5" x:Name="verticalAlignmentComboBox" IsEnabled="{Binding HasSelectedElement}" SelectedValue="{Binding SelectedElementVerticalAlignment}">
                                                    <ComboBoxItem Content="顶部" Tag="Top"/>
                                                    <ComboBoxItem Content="居中" Tag="Center"/>
                                                    <ComboBoxItem Content="底部" Tag="Bottom"/>
                                                </ComboBox>
                                                
                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="文本颜色:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="2" Grid.Column="1" Margin="5" x:Name="foregroundColorTextBox" IsEnabled="{Binding HasSelectedElement}" Text="{Binding SelectedElementForegroundColor}"/>
                                                
                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="背景颜色:" Margin="5,5,0,5"/>
                                                <TextBox Grid.Row="3" Grid.Column="1" Margin="5" x:Name="textBackgroundColorTextBox" IsEnabled="{Binding HasSelectedElement}" Text="{Binding SelectedElementTextBackgroundColor}"/>
                                            </Grid>
                                        </StackPanel>
                                    </Expander>
                                    
                                    <!-- 数据绑定属性 -->
                                    <Expander Header="数据绑定" Style="{StaticResource PropertyGroupStyle}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="路径:" Margin="5,5,0,5" VerticalAlignment="Center"/>
                                            <TextBox Grid.Row="0" Grid.Column="1" Margin="5" x:Name="dataPathTextBox" IsEnabled="{Binding HasSelectedElement}" Text="{Binding SelectedElementDataPath}" VerticalAlignment="Center"/>
                                            <Button Grid.Row="0" Grid.Column="2" Margin="5" x:Name="selectPathButton" Content="选择" Width="50" Height="25" Command="{Binding SelectDataPathCommand}" VerticalAlignment="Center"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="格式:" Margin="5,5,0,5" VerticalAlignment="Center"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" Margin="5" x:Name="formatStringTextBox" IsEnabled="{Binding HasSelectedElement}" Text="{Binding SelectedElementFormatString}" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Row="1" Grid.Column="2" Text="" Margin="5" VerticalAlignment="Center"/>
                                        </Grid>
                                    </Expander>
                                    
                                    <!-- 标签输入框属性 -->
                                    <Expander Header="标签输入框属性" Style="{StaticResource PropertyGroupStyle}" Visibility="Collapsed" x:Name="labelInputBoxPropertiesPanel">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="标签文本：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="txtLabelText" Margin="5" TextChanged="txtLabelText_TextChanged"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="标签位置：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <ComboBox Grid.Row="1" Grid.Column="1" x:Name="cmbLabelPosition" Margin="5">
                                                <ComboBoxItem Content="左侧" Tag="Left" IsSelected="True"/>
                                                <ComboBoxItem Content="顶部" Tag="Top"/>
                                                <ComboBoxItem Content="右侧" Tag="Right"/>
                                            </ComboBox>
                                            
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="标签字体大小：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="2" Grid.Column="1" x:Name="txtLabelFontSize" Margin="5" TextChanged="txtLabelFontSize_TextChanged"/>
                                            
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="标签字体粗细：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <ComboBox Grid.Row="3" Grid.Column="1" x:Name="cmbLabelFontWeight" Margin="5">
                                                <ComboBoxItem Content="Normal" Tag="Normal" IsSelected="True"/>
                                                <ComboBoxItem Content="Bold" Tag="Bold"/>
                                            </ComboBox>
                                            
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="标签颜色：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Margin="5">
                                                <TextBox x:Name="txtLabelForegroundColor" Width="80" Margin="0,0,5,0" TextChanged="txtLabelForegroundColor_TextChanged"/>
                                                <Button Content="..." Width="25" Click="btnLabelForegroundColor_Click"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Row="5" Grid.Column="0" Text="标签背景颜色：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="5">
                                                <TextBox x:Name="txtLabelBackgroundColor" Width="80" Margin="0,0,5,0" TextChanged="txtLabelBackgroundColor_TextChanged"/>
                                                <Button Content="..." Width="25" Click="btnLabelBackgroundColor_Click"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Row="6" Grid.Column="0" Text="输入框宽度：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="6" Grid.Column="1" x:Name="txtInputWidth" Margin="5" TextChanged="txtInputWidth_TextChanged"/>
                                            
                                            <TextBlock Grid.Row="7" Grid.Column="0" Text="输入框高度：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="7" Grid.Column="1" x:Name="txtInputHeight" Margin="5" TextChanged="txtInputHeight_TextChanged"/>
                                            
                                            <TextBlock Grid.Row="8" Grid.Column="0" Text="默认值：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="8" Grid.Column="1" x:Name="txtDefaultValue" Margin="5" TextChanged="txtDefaultValue_TextChanged"/>
                                            
                                            <TextBlock Grid.Row="9" Grid.Column="0" Text="占位符：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="9" Grid.Column="1" x:Name="txtPlaceholder" Margin="5" TextChanged="txtPlaceholder_TextChanged"/>
                                            
                                            <TextBlock Grid.Row="10" Grid.Column="0" Text="输入框背景颜色：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <StackPanel Grid.Row="10" Grid.Column="1" Orientation="Horizontal" Margin="5">
                                                <TextBox x:Name="txtInputBackgroundColor" Width="80" Margin="0,0,5,0" TextChanged="txtInputBackgroundColor_TextChanged"/>
                                                <Button Content="..." Width="25" Click="btnInputBackgroundColor_Click"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Row="11" Grid.Column="0" Text="输入框边框颜色：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <StackPanel Grid.Row="11" Grid.Column="1" Orientation="Horizontal" Margin="5">
                                                <TextBox x:Name="txtInputBorderColor" Width="80" Margin="0,0,5,0" TextChanged="txtInputBorderColor_TextChanged"/>
                                                <Button Content="..." Width="25" Click="btnInputBorderColor_Click"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Row="12" Grid.Column="0" Text="输入框边框宽度：" VerticalAlignment="Center" Margin="5,5,0,5"/>
                                            <TextBox Grid.Row="12" Grid.Column="1" x:Name="txtInputBorderWidth" Margin="5" TextChanged="txtInputBorderWidth_TextChanged"/>
                                        </Grid>
                                    </Expander>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>
                        <TabItem Header="数据预览">
                            <Grid Margin="5">
                                <StackPanel>
                                    <Border BorderThickness="1" BorderBrush="#E0E0E0" Background="White" Margin="0,0,0,5">
                                        <Canvas x:Name="previewCanvas" Width="200" Height="100" Background="White">
                                            <!-- 预览内容将在这里动态生成 -->
                                        </Canvas>
                                    </Border>
                                    <Button x:Name="loadDataButton" Content="加载测试数据" Margin="0,5,0,0" Command="{Binding LoadTestDataCommand}"/>
                                    <Button x:Name="refreshPreviewButton" Content="刷新预览" Command="{Binding RefreshPreviewCommand}"/>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
        </Grid>
        
        <!-- 状态栏 -->
        <Border Grid.Row="3" BorderThickness="0,1,0,0" BorderBrush="#E0E0E0">
            <StatusBar Background="#F0F0F0">
                <StatusBarItem>
                    <TextBlock x:Name="statusText" Text="就绪"/>
                </StatusBarItem>
                <StatusBarItem HorizontalAlignment="Right">
                    <TextBlock Text="DPI: 96" Margin="5,0,0,0"/>
                </StatusBarItem>
            </StatusBar>
        </Border>
    </Grid>
</Window>