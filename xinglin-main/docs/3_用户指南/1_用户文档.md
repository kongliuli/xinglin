# 用户文档

## 1. 系统概述

“杏林”病理检验报告系统是一个面向医院检验科的本地化报告录入与打印工具，采用模块化设计，支持多源数据接入、动态模板生成和微信查询等功能。

## 2. 系统安装

### 2.1 系统要求

| 项目 | 要求 |
|------|------|
| 操作系统 | Windows 10 或更高版本 |
| .NET 版本 | .NET 8.0 或更高版本 |
| 内存 | 至少 4GB RAM |
| 硬盘空间 | 至少 1GB 可用空间 |
| 分辨率 | 1920x1080 或更高 |

### 2.2 安装步骤

1. 从官方网站下载最新版本的安装包
2. 双击安装包文件，启动安装向导
3. 按照安装向导的提示完成安装
4. 安装完成后，桌面会生成快捷方式

### 2.3 首次启动

1. 双击桌面快捷方式启动应用
2. 系统会自动检查更新
3. 首次启动时，需要进行基本配置

## 3. 系统配置

### 3.1 基本配置

1. 启动应用后，进入设置界面
2. 设置医院信息
3. 设置数据源连接
4. 设置默认打印机
5. 保存配置

### 3.2 数据源配置

1. 在设置界面中，选择“数据源配置”
2. 点击“添加数据源”
3. 选择数据源类型（数据库、文件等）
4. 填写数据源连接信息
5. 测试连接
6. 保存配置

### 3.3 模板配置

1. 在设置界面中，选择“模板配置”
2. 设置默认模板路径
3. 设置模板版本控制策略
4. 保存配置

## 4. 系统使用

### 4.1 模板设计

1. 启动应用，点击“模板设计”
2. 选择“新建模板”或“打开模板”
3. 在模板设计界面中，添加和编辑元素
4. 设置元素属性和数据绑定
5. 实时预览模板效果
6. 保存模板

### 4.2 报告生成

1. 启动应用，点击“报告生成”
2. 输入病人信息或从数据源选择
3. 选择模板
4. 系统自动填充数据
5. 预览报告
6. 打印或导出报告

### 4.3 报告查询

1. 启动应用，点击“报告查询”
2. 输入查询条件（病人姓名、ID、日期范围等）
3. 点击“查询”
4. 在查询结果中选择报告
5. 查看、打印或导出报告

### 4.4 微信查询

1. 确保系统已配置微信服务
2. 报告生成后，自动同步到微信服务
3. 病人通过微信公众号查询报告
4. 扫描二维码或输入查询码获取报告

## 5. 常见问题

### 5.1 模板无法保存

- 检查模板路径是否存在且有写入权限
- 检查模板文件是否被占用
- 检查磁盘空间是否充足

### 5.2 报告生成失败

- 检查数据源连接是否正常
- 检查模板是否有语法错误
- 检查数据是否符合模板要求

### 5.3 打印失败

- 检查打印机是否连接正常
- 检查打印机驱动是否安装正确
- 检查打印机是否有纸张和墨水

### 5.4 微信查询不到报告

- 检查网络连接是否正常
- 检查微信服务配置是否正确
- 检查报告是否已同步到微信服务

## 6. 故障处理

### 6.1 系统崩溃

- 查看日志文件，定位错误原因
- 重启应用
- 如果问题持续，联系技术支持

### 6.2 数据丢失

- 检查数据备份情况
- 恢复最近的备份
- 联系技术支持进行数据恢复

### 6.3 性能问题

- 关闭不必要的应用
- 清理系统缓存
- 优化数据库索引
- 考虑升级硬件

## 7. 技术支持

### 7.1 联系方式

- 技术支持邮箱：support@xinglin.com
- 技术支持电话：400-123-4567
- 在线支持：登录系统后点击“在线支持”

### 7.2 服务时间

- 工作日：9:00-18:00
- 节假日：10:00-16:00

## 8. 版本更新

### 8.1 自动更新

1. 系统会定期检查更新
2. 发现更新后，自动下载并安装
3. 安装完成后，重启应用

### 8.2 手动更新

1. 从官方网站下载最新版本
2. 关闭当前运行的应用
3. 运行安装包进行更新
4. 启动应用，验证更新

## 9. 注意事项

1. 定期备份数据和模板
2. 不要修改系统文件和配置
3. 不要使用未经授权的插件
4. 定期更新系统和驱动
5. 确保网络安全，防止数据泄露

## 10. 术语解释

| 术语 | 解释 |
|------|------|
| 模板 | 报告的格式定义，包含元素、属性和数据绑定 |
| 元素 | 模板中的基本组件，如文本、图片、线条等 |
| 数据绑定 | 将模板元素与数据源字段关联的机制 |
| 渲染 | 将模板和数据结合生成最终报告的过程 |
| 微信查询码 | 用于病人通过微信查询报告的唯一标识 |

## 11. 附录

### 11.1 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+N | 新建模板 |
| Ctrl+O | 打开模板 |
| Ctrl+S | 保存模板 |
| Ctrl+P | 打印报告 |
| Ctrl+Z | 撤销操作 |
| Ctrl+Y | 重做操作 |
| F5 | 预览报告 |
| F1 | 打开帮助 |

### 11.2 错误代码

| 错误代码 | 描述 | 解决方案 |
|----------|------|----------|
| E001 | 数据源连接失败 | 检查数据源连接信息和网络状态 |
| E002 | 模板文件损坏 | 从备份恢复模板或重新创建 |
| E003 | 打印机不可用 | 检查打印机连接和状态 |
| E004 | 微信服务连接失败 | 检查网络连接和微信服务配置 |
| E005 | 数据验证失败 | 检查输入数据是否符合要求 |

### 11.3 日志查看

1. 启动应用，点击“设置”
2. 选择“日志管理”
3. 查看系统日志
4. 导出日志（用于技术支持）