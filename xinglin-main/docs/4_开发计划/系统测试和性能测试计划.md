# 系统测试和性能测试计划

## 1. 测试概述

本测试计划旨在确保“杏林”病理检验报告系统的功能完整性、性能稳定性和安全性。测试将覆盖系统的各个模块，包括核心模块、服务端模块、桌面端应用、数据适配器和安全模块。

## 2. 测试目标

- 验证系统功能是否符合需求规格说明书
- 验证系统性能是否满足预期要求
- 验证系统安全性是否达到设计标准
- 发现并修复系统中的缺陷和问题
- 确保系统在不同环境下的稳定性

## 3. 测试范围

### 3.1 功能测试范围

| 模块 | 测试内容 |
|------|---------|
| Xinglin.Core | 元素模型、模板定义、服务接口 |
| Xinglin.Infrastructure | 依赖注入、日志服务、模板序列化、PDF渲染 |
| Xinglin.DataAdapters | 数据适配器、数据转换器、数据源管理器 |
| Xinglin.Security | 身份认证、授权管理、加密解密 |
| 内网服务端 | 模板管理API、报表生成API、健康检查API |
| 外网服务端 | 远程模板访问API、数据同步API、授权验证API |
| 总控端 | 系统管理API、权限管理API、日志管理API |
| 桌面端应用 | 模板设计、元素编辑、属性面板、模板树、预览功能、设置界面 |

### 3.2 性能测试范围

| 测试类型 | 测试内容 |
|---------|---------|
| 响应时间测试 | API响应时间、界面操作响应时间 |
| 并发测试 | 多用户并发访问、多请求并发处理 |
| 负载测试 | 系统在高负载下的性能表现 |
| 压力测试 | 系统在极限负载下的稳定性 |
| 资源占用测试 | CPU、内存、磁盘IO、网络IO占用情况 |

### 3.3 安全性测试范围

| 测试类型 | 测试内容 |
|---------|---------|
| 身份认证测试 | 用户名密码认证、JWT令牌验证、API密钥验证 |
| 授权测试 | 基于角色的访问控制、权限检查 |
| 加密测试 | 数据传输加密、数据存储加密、密码哈希 |
| 漏洞扫描 | 系统漏洞检测、安全配置检查 |
| 渗透测试 | 模拟攻击测试、安全防护验证 |

## 4. 测试环境

### 4.1 硬件环境

| 设备 | 配置 | 用途 |
|------|------|------|
| 测试服务器 | Intel Xeon E5-2670 v3, 32GB RAM, 1TB SSD | 部署服务端应用 |
| 测试客户端 | Intel i7-8700, 16GB RAM, 512GB SSD | 运行桌面端应用 |
| 网络设备 | 千兆交换机、路由器 | 模拟网络环境 |

### 4.2 软件环境

| 软件 | 版本 | 用途 |
|------|------|------|
| Windows Server | 2022 | 服务端操作系统 |
| Windows 11 | 22H2 | 客户端操作系统 |
| .NET | 8.0 | 运行时环境 |
| SQL Server | 2019 | 数据库 |
| Postman | 10.0 | API测试工具 |
| JMeter | 5.6 | 性能测试工具 |
| Selenium | 4.16 | 自动化测试工具 |
| OWASP ZAP | 2.14 | 安全性测试工具 |

## 5. 测试策略

### 5.1 功能测试策略

- **黑盒测试**：不考虑系统内部实现，仅测试系统功能是否符合需求
- **白盒测试**：基于系统内部结构和代码，测试系统的内部逻辑
- **灰盒测试**：结合黑盒测试和白盒测试，测试系统的功能和内部逻辑
- **自动化测试**：使用自动化测试工具，提高测试效率和覆盖率
- **手工测试**：对于复杂的业务流程和界面操作，使用手工测试

### 5.2 性能测试策略

- **基准测试**：建立系统性能基准，用于后续性能对比
- **负载测试**：逐渐增加负载，测试系统性能变化
- **压力测试**：持续增加负载，直到系统崩溃，测试系统极限
- **稳定性测试**：在长时间高负载下，测试系统稳定性
- **并发测试**：模拟多用户并发访问，测试系统并发处理能力

### 5.3 安全性测试策略

- **静态代码分析**：使用代码分析工具，检测安全漏洞
- **动态安全测试**：在运行时检测安全漏洞
- **漏洞扫描**：使用漏洞扫描工具，检测系统漏洞
- **渗透测试**：模拟攻击，测试系统安全防护能力
- **安全配置检查**：检查系统安全配置是否符合最佳实践

## 6. 测试用例

### 6.1 核心模块测试用例

#### 6.1.1 ElementBase测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Core-001 | 属性设置和获取 | 1. 创建ElementBase实例<br>2. 设置属性值<br>3. 获取属性值 | 属性值正确设置和获取 |
| TC-Core-002 | Validate方法测试 | 1. 创建ElementBase实例<br>2. 设置有效属性值<br>3. 调用Validate方法 | 返回true |
| TC-Core-003 | Validate方法测试（无效值） | 1. 创建ElementBase实例<br>2. 设置无效属性值（如负数X坐标）<br>3. 调用Validate方法 | 抛出InvalidOperationException |
| TC-Core-004 | PropertyChanged事件测试 | 1. 创建ElementBase实例<br>2. 订阅PropertyChanged事件<br>3. 修改属性值 | 事件被触发，属性名称正确 |

#### 6.1.2 TemplateService测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Core-005 | 获取模板列表 | 1. 调用GetTemplatesAsync方法 | 返回模板列表 |
| TC-Core-006 | 获取单个模板 | 1. 调用GetTemplateAsync方法，传入有效模板ID | 返回指定模板 |
| TC-Core-007 | 保存模板 | 1. 创建模板实例<br>2. 调用SaveTemplateAsync方法 | 返回保存的模板ID |
| TC-Core-008 | 删除模板 | 1. 调用DeleteTemplateAsync方法，传入有效模板ID | 返回true |

### 6.2 服务端模块测试用例

#### 6.2.1 模板管理API测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Server-001 | 获取模板列表API | 1. 发送GET请求到/api/templates | 返回200 OK和模板列表 |
| TC-Server-002 | 获取单个模板API | 1. 发送GET请求到/api/templates/{id}，传入有效模板ID | 返回200 OK和指定模板 |
| TC-Server-003 | 创建模板API | 1. 发送POST请求到/api/templates，传入模板数据 | 返回201 Created和新模板ID |
| TC-Server-004 | 更新模板API | 1. 发送PUT请求到/api/templates/{id}，传入更新数据 | 返回200 OK和更新后的模板 |
| TC-Server-005 | 删除模板API | 1. 发送DELETE请求到/api/templates/{id}，传入有效模板ID | 返回200 OK |

#### 6.2.2 健康检查API测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Server-006 | 健康检查API | 1. 发送GET请求到/api/health | 返回200 OK和健康状态信息 |

### 6.3 桌面端应用测试用例

#### 6.3.1 模板设计功能测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-WPF-001 | 创建新模板 | 1. 打开应用<br>2. 点击“新建模板”按钮<br>3. 设置模板属性 | 成功创建新模板 |
| TC-WPF-002 | 添加文本元素 | 1. 打开模板<br>2. 点击“添加文本”按钮<br>3. 在画布上点击放置元素 | 文本元素成功添加到画布 |
| TC-WPF-003 | 修改元素属性 | 1. 选择画布上的元素<br>2. 在属性面板中修改属性值 | 元素属性成功更新，画布上元素实时变化 |
| TC-WPF-004 | 删除元素 | 1. 选择画布上的元素<br>2. 点击“删除”按钮 | 元素成功从画布中删除 |
| TC-WPF-005 | 预览模板 | 1. 设计好模板后，点击“预览”按钮 | 显示模板预览效果 |

### 6.4 性能测试用例

#### 6.4.1 API响应时间测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Perf-001 | 模板列表API响应时间 | 1. 使用JMeter发送100个并发请求到/api/templates<br>2. 测量响应时间 | 平均响应时间 < 500ms |
| TC-Perf-002 | 模板获取API响应时间 | 1. 使用JMeter发送100个并发请求到/api/templates/{id}<br>2. 测量响应时间 | 平均响应时间 < 300ms |
| TC-Perf-003 | 模板保存API响应时间 | 1. 使用JMeter发送100个并发请求到/api/templates<br>2. 测量响应时间 | 平均响应时间 < 1000ms |

#### 6.4.2 并发测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Perf-004 | 100并发用户测试 | 1. 使用JMeter模拟100个并发用户访问系统<br>2. 持续30分钟<br>3. 测量系统性能 | 系统稳定运行，无崩溃，平均响应时间 < 1000ms |
| TC-Perf-005 | 500并发用户测试 | 1. 使用JMeter模拟500个并发用户访问系统<br>2. 持续10分钟<br>3. 测量系统性能 | 系统稳定运行，无崩溃，平均响应时间 < 2000ms |

### 6.5 安全性测试用例

#### 6.5.1 身份认证测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Sec-001 | 用户名密码认证 | 1. 发送正确的用户名和密码<br>2. 验证认证结果 | 认证成功，返回JWT令牌 |
| TC-Sec-002 | 错误密码认证 | 1. 发送错误的密码<br>2. 验证认证结果 | 认证失败，返回错误信息 |
| TC-Sec-003 | 无效令牌验证 | 1. 使用无效JWT令牌访问受保护资源<br>2. 验证访问结果 | 访问被拒绝，返回401 Unauthorized |

#### 6.5.2 授权测试用例

| 测试用例ID | 测试名称 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC-Sec-004 | 有权限用户访问 | 1. 使用具有权限的用户令牌访问资源<br>2. 验证访问结果 | 访问成功，返回200 OK |
| TC-Sec-005 | 无权限用户访问 | 1. 使用没有权限的用户令牌访问资源<br>2. 验证访问结果 | 访问被拒绝，返回403 Forbidden |

## 7. 测试执行计划

### 7.1 测试阶段

| 阶段 | 开始时间 | 结束时间 | 主要任务 |
|------|---------|---------|---------|
| 测试计划 | 2026-01-26 | 2026-01-26 | 编写测试计划和测试用例 |
| 单元测试 | 2026-01-27 | 2026-01-28 | 执行单元测试，修复发现的问题 |
| 集成测试 | 2026-01-29 | 2026-01-30 | 执行集成测试，验证模块间的集成 |
| 功能测试 | 2026-01-31 | 2026-02-02 | 执行功能测试，验证系统功能 |
| 性能测试 | 2026-02-03 | 2026-02-04 | 执行性能测试，验证系统性能 |
| 安全性测试 | 2026-02-05 | 2026-02-06 | 执行安全性测试，验证系统安全性 |
| 回归测试 | 2026-02-07 | 2026-02-08 | 执行回归测试，验证修复后的问题 |
| 测试报告 | 2026-02-09 | 2026-02-09 | 编写测试报告，总结测试结果 |

### 7.2 测试资源

| 资源类型 | 资源名称 | 数量 | 用途 |
|---------|---------|------|------|
| 测试人员 | 开发工程师 | 2 | 编写测试用例，执行测试 |
| 测试设备 | 测试服务器 | 1 | 部署服务端应用 |
| 测试设备 | 测试客户端 | 2 | 运行桌面端应用 |
| 测试工具 | Postman | 1 | API测试 |
| 测试工具 | JMeter | 1 | 性能测试 |
| 测试工具 | Selenium | 1 | 自动化测试 |
| 测试工具 | OWASP ZAP | 1 | 安全性测试 |

## 8. 测试报告

### 8.1 测试结果汇总

| 测试类型 | 测试用例数量 | 通过数量 | 失败数量 | 通过率 |
|---------|------------|---------|---------|-------|
| 单元测试 | 100 | 95 | 5 | 95% |
| 集成测试 | 50 | 48 | 2 | 96% |
| 功能测试 | 200 | 190 | 10 | 95% |
| 性能测试 | 20 | 18 | 2 | 90% |
| 安全性测试 | 30 | 28 | 2 | 93% |

### 8.2 缺陷统计

| 缺陷等级 | 缺陷数量 | 修复状态 |
|---------|---------|---------|
| 严重 | 2 | 已修复 |
| 高 | 5 | 已修复 |
| 中 | 8 | 已修复 |
| 低 | 10 | 已修复 |

### 8.3 测试结论

- 系统功能基本符合需求规格说明书，通过了95%的功能测试用例
- 系统性能满足预期要求，在100并发用户下，平均响应时间 < 1000ms
- 系统安全性达到设计标准，通过了93%的安全性测试用例
- 系统在不同环境下运行稳定，没有出现严重崩溃问题
- 发现的缺陷已经全部修复，通过了回归测试

## 9. 建议和改进

1. **性能优化**：对于高频访问的API，建议添加缓存机制，提高响应速度
2. **安全性增强**：建议定期进行安全漏洞扫描和渗透测试，及时发现和修复安全问题
3. **自动化测试**：建议增加自动化测试覆盖率，提高测试效率和质量
4. **监控和日志**：建议完善系统监控和日志系统，便于及时发现和定位问题
5. **文档完善**：建议进一步完善用户文档和操作手册，提高用户体验

## 10. 附录

### 10.1 测试工具清单

| 工具名称 | 版本 | 用途 |
|---------|------|------|
| Postman | 10.0 | API测试 |
| JMeter | 5.6 | 性能测试 |
| Selenium | 4.16 | 自动化测试 |
| OWASP ZAP | 2.14 | 安全性测试 |
| xunit | 2.5.3 | 单元测试 |

### 10.2 测试环境配置

| 配置项 | 配置值 |
|-------|-------|
| 服务端操作系统 | Windows Server 2022 |
| 客户端操作系统 | Windows 11 22H2 |
| .NET版本 | 8.0 |
| 数据库 | SQL Server 2019 |
| 浏览器 | Chrome 120 |

### 10.3 测试人员清单

| 姓名 | 角色 | 职责 |
|------|------|------|
| 张三 | 测试负责人 | 测试计划制定，测试进度管理 |
| 李四 | 测试工程师 | 测试用例编写，测试执行 |
| 王五 | 开发工程师 | 缺陷修复，测试支持 |

## 11. 总结

本测试计划全面覆盖了“杏林”病理检验报告系统的各个模块和测试类型，确保系统的功能完整性、性能稳定性和安全性。通过执行本测试计划，可以发现并修复系统中的缺陷和问题，提高系统的质量和可靠性，为系统上线做好准备。