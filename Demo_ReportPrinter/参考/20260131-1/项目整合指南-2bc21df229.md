# é¡¹ç›®æ•´åˆæŒ‡å—

> æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0
> åˆ›å»ºæ—¥æœŸï¼š2026-01-31
> é€‚ç”¨é¡¹ç›®ï¼šDemo_ReportPrinter

---

## ğŸ“‹ ç›®å½•

1. [æ–‡ä»¶æ¸…å•](#æ–‡ä»¶æ¸…å•)
2. [ç›®å½•ç»“æ„è§„åˆ’](#ç›®å½•ç»“æ„è§„åˆ’)
3. [æ•´åˆæ­¥éª¤](#æ•´åˆæ­¥éª¤)
4. [ç¼–è¯‘é…ç½®](#ç¼–è¯‘é…ç½®)
5. [æµ‹è¯•éªŒè¯](#æµ‹è¯•éªŒè¯)
6. [å¸¸è§é—®é¢˜è§£å†³](#å¸¸è§é—®é¢˜è§£å†³)

---

## ä¸€ã€æ–‡ä»¶æ¸…å•

### 1.1 æ–°å¢æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶å | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| `PaperSizeConstants.cs` | çº¸å¼ è§„æ ¼ç³»ç»Ÿï¼ˆæšä¸¾ã€ä¿¡æ¯ç±»ã€å·¥å…·ç±»ï¼‰| ğŸ”´ é«˜ |
| `Constants.cs` | ç»Ÿä¸€å¸¸é‡ä½“ç³»ï¼ˆå·²æ›´æ–°ï¼‰| ğŸ”´ é«˜ |
| `CoordinateHelper.cs` | åæ ‡è½¬æ¢è¾…åŠ©ç±» | ğŸ”´ é«˜ |
| `DragBehavior.cs` | æ‹–æ‹½è¡Œä¸º | ğŸ”´ é«˜ |
| `ResizeBehavior.cs` | è°ƒæ•´å¤§å°è¡Œä¸º | ğŸ”´ é«˜ |
| `SnapBehavior.cs` | å¸é™„å¯¹é½è¡Œä¸º | ğŸŸ¡ ä¸­ |
| `ControlTemplateSelector.cs` | æ§ä»¶æ¨¡æ¿é€‰æ‹©å™¨ | ğŸ”´ é«˜ |

### 1.2 å¢å¼ºç‰ˆæ–‡ä»¶

| æ–‡ä»¶å | è¯´æ˜ | æ“ä½œ |
|--------|------|------|
| `TemplateEditorPanel_Enhanced.xaml` | å¢å¼ºç‰ˆ XAML å¸ƒå±€ | æ›¿æ¢ç°æœ‰æ–‡ä»¶ |
| `TemplateEditorPanel_Enhanced.xaml.cs` | å¢å¼ºç‰ˆä»£ç åå° | åˆå¹¶åˆ°ç°æœ‰æ–‡ä»¶ |

### 1.3 æµ‹è¯•æ–‡ä»¶

| æ–‡ä»¶å | è¯´æ˜ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| `PaperSizeTests.cs` | çº¸å¼ è§„æ ¼å•å…ƒæµ‹è¯• | ğŸŸ¢ ä½ |
| `CoordinateHelperTests.cs` | åæ ‡è½¬æ¢å•å…ƒæµ‹è¯• | ğŸŸ¢ ä½ |

### 1.4 æ–‡æ¡£æ–‡ä»¶

| æ–‡ä»¶å | è¯´æ˜ |
|--------|------|
| `å¸¸é‡æ•´åˆä¸æ¶æ„ä¼˜åŒ–è§„åˆ’æŠ¥å‘Š.md` | æ¶æ„è§„åˆ’æ–‡æ¡£ |

---

## äºŒã€ç›®å½•ç»“æ„è§„åˆ’

### 2.1 æ¨èç›®å½•ç»“æ„

```
Demo_ReportPrinter/
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ CoreEntities/
â”‚       â”œâ”€â”€ ControlElement.cs              (å·²å­˜åœ¨)
â”‚       â”œâ”€â”€ LayoutMetadata.cs              (å·²å­˜åœ¨)
â”‚       â””â”€â”€ PaperSizeConstants.cs          (æ–°å¢) âœ¨
â”‚
â”œâ”€â”€ Constants/
â”‚   â””â”€â”€ Constants.cs                        (å·²æ›´æ–°) âœ¨
â”‚
â”œâ”€â”€ Helpers/
â”‚   â””â”€â”€ CoordinateHelper.cs                  (æ–°å¢) âœ¨
â”‚
â”œâ”€â”€ Behaviors/
â”‚   â”œâ”€â”€ DragBehavior.cs                     (æ–°å¢) âœ¨
â”‚   â”œâ”€â”€ ResizeBehavior.cs                   (æ–°å¢) âœ¨
â”‚   â””â”€â”€ SnapBehavior.cs                     (æ–°å¢) âœ¨
â”‚
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ TemplateEditorPanel.xaml            (å·²å­˜åœ¨ï¼Œéœ€æ›¿æ¢ä¸ºå¢å¼ºç‰ˆ)
â”‚   â”œâ”€â”€ TemplateEditorPanel.xaml.cs          (å·²å­˜åœ¨ï¼Œéœ€åˆå¹¶å¢å¼ºç‰ˆä»£ç )
â”‚   â””â”€â”€ ControlTemplateSelector.cs          (æ–°å¢) âœ¨
â”‚
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ TemplateEditorViewModel.cs          (å·²å­˜åœ¨ï¼Œéœ€ç¡®è®¤å¼•ç”¨)
â”‚
â””â”€â”€ Tests/
    â”œâ”€â”€ PaperSizeTests.cs                    (æ–°å¢) âœ¨
    â””â”€â”€ CoordinateHelperTests.cs            (æ–°å¢) âœ¨
```

### 2.2 éœ€è¦åˆ›å»ºçš„ç›®å½•

1. **`Helpers/`** - å­˜æ”¾è¾…åŠ©å·¥å…·ç±»
2. **`Behaviors/`** - å­˜æ”¾è¡Œä¸ºç±»
3. **`Tests/`** - å­˜æ”¾å•å…ƒæµ‹è¯•

---

## ä¸‰ã€æ•´åˆæ­¥éª¤

### æ­¥éª¤1ï¼šåˆ›å»ºç›®å½•ç»“æ„

```bash
cd Demo_ReportPrinter

# åˆ›å»ºç›®å½•
mkdir Helpers
mkdir Behaviors
mkdir Tests
```

### æ­¥éª¤2ï¼šå¤åˆ¶æ ¸å¿ƒæ–‡ä»¶

#### 2.1 å¤åˆ¶çº¸å¼ è§„æ ¼ç³»ç»Ÿ

å°† `PaperSizeConstants.cs` å¤åˆ¶åˆ° `Demo_ReportPrinter/Models/CoreEntities/` ç›®å½•

```bash
cp PaperSizeConstants.cs Demo_ReportPrinter/Models/CoreEntities/
```

**éªŒè¯å‘½åç©ºé—´ï¼š**
ç¡®ä¿æ–‡ä»¶é¡¶éƒ¨çš„å‘½åç©ºé—´ä¸ºï¼š
```csharp
namespace Demo_ReportPrinter.Models.CoreEntities
```

#### 2.2 å¤åˆ¶å¸¸é‡æ–‡ä»¶

`Constants.cs` å·²ç»æ›´æ–°ï¼Œç¡®ä¿å®ƒåœ¨ `Demo_ReportPrinter/Constants/` ç›®å½•

**éªŒè¯å‘½åç©ºé—´ï¼š**
```csharp
namespace Demo_ReportPrinter.Constants
```

#### 2.3 å¤åˆ¶åæ ‡è½¬æ¢è¾…åŠ©ç±»

å°† `CoordinateHelper.cs` å¤åˆ¶åˆ° `Demo_ReportPrinter/Helpers/` ç›®å½•

```bash
cp CoordinateHelper.cs Demo_ReportPrinter/Helpers/
```

**éªŒè¯å‘½åç©ºé—´ï¼š**
```csharp
namespace Demo_ReportPrinter.Helpers
```

#### 2.4 å¤åˆ¶è¡Œä¸ºç±»

```bash
cp DragBehavior.cs Demo_ReportPrinter/Behaviors/
cp ResizeBehavior.cs Demo_ReportPrinter/Behaviors/
cp SnapBehavior.cs Demo_ReportPrinter/Behaviors/
```

**éªŒè¯å‘½åç©ºé—´ï¼š**
```csharp
namespace Demo_ReportPrinter.Behaviors
```

#### 2.5 å¤åˆ¶æ§ä»¶æ¨¡æ¿é€‰æ‹©å™¨

å°† `ControlTemplateSelector.cs` å¤åˆ¶åˆ° `Demo_ReportPrinter/Views/` ç›®å½•

```bash
cp ControlTemplateSelector.cs Demo_ReportPrinter/Views/
```

**éªŒè¯å‘½åç©ºé—´ï¼š**
```csharp
namespace Demo_ReportPrinter.Views
```

#### 2.6 å¤åˆ¶æµ‹è¯•æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

```bash
mkdir -p Demo_ReportPrinter/Tests
cp PaperSizeTests.cs Demo_ReportPrinter/Tests/
cp CoordinateHelperTests.cs Demo_ReportPrinter/Tests/
```

**éªŒè¯å‘½åç©ºé—´ï¼š**
```csharp
namespace Demo_ReportPrinter.Tests
```

### æ­¥éª¤3ï¼šæ›´æ–° XAML æ–‡ä»¶

#### 3.1 æ›¿æ¢ TemplateEditorPanel.xaml

```bash
# å¤‡ä»½åŸæ–‡ä»¶
cp Demo_ReportPrinter/Views/TemplateEditorPanel.xaml Demo_ReportPrinter/Views/TemplateEditorPanel.xaml.bak

# å¤åˆ¶å¢å¼ºç‰ˆæ–‡ä»¶
cp TemplateEditorPanel_Enhanced.xaml Demo_ReportPrinter/Views/TemplateEditorPanel.xaml
```

#### 3.2 åˆå¹¶ TemplateEditorPanel.xaml.cs

**æ–¹æ¡ˆAï¼šç›´æ¥æ›¿æ¢ï¼ˆæ¨èï¼‰**
```bash
# å¤‡ä»½åŸæ–‡ä»¶
cp Demo_ReportPrinter/Views/TemplateEditorPanel.xaml.cs Demo_ReportPrinter/Views/TemplateEditorPanel.xaml.cs.bak

# å¤åˆ¶å¢å¼ºç‰ˆæ–‡ä»¶
cp TemplateEditorPanel_Enhanced.xaml.cs Demo_ReportPrinter/Views/TemplateEditorPanel.xaml.cs
```

**æ–¹æ¡ˆBï¼šæ‰‹åŠ¨åˆå¹¶**
å¦‚æœåŸæ–‡ä»¶æœ‰è‡ªå®šä¹‰ä»£ç ï¼Œæ‰‹åŠ¨åˆå¹¶ä»¥ä¸‹éƒ¨åˆ†ï¼š

1. **ä¿ç•™**ï¼šæ‰€æœ‰ç°æœ‰ä»£ç 
2. **æ·»åŠ **ï¼šä»å¢å¼ºç‰ˆæ–‡ä»¶ä¸­å¤åˆ¶æ‰€æœ‰ä»£ç åˆ°ç°æœ‰æ–‡ä»¶ä¸­

### æ­¥éª¤4ï¼šæ›´æ–°é¡¹ç›®æ–‡ä»¶

#### 4.1 ç¼–è¾‘ `.csproj` æ–‡ä»¶

æ‰¾åˆ°é¡¹ç›®æ–‡ä»¶ï¼ˆå¦‚ `Demo_ReportPrinter.csproj`ï¼‰ï¼Œåœ¨ `<ItemGroup>` ä¸­æ·»åŠ ï¼š

```xml
<!-- Models/CoreEntities -->
<Compile Include="Models\CoreEntities\PaperSizeConstants.cs" />

<!-- Helpers -->
<Compile Include="Helpers\CoordinateHelper.cs" />

<!-- Behaviors -->
<Compile Include="Behaviors\DragBehavior.cs" />
<Compile Include="Behaviors\ResizeBehavior.cs" />
<Compile Include="Behaviors\SnapBehavior.cs" />

<!-- Views -->
<Compile Include="Views\ControlTemplateSelector.cs" />

<!-- Tests (å¦‚æœéœ€è¦) -->
<Compile Include="Tests\PaperSizeTests.cs" />
<Compile Include="Tests\CoordinateHelperTests.cs" />
```

**æ³¨æ„ï¼š** å¦‚æœä½¿ç”¨ Visual Studioï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è‡ªåŠ¨æ·»åŠ ï¼š

1. åœ¨ Visual Studio ä¸­æ‰“å¼€é¡¹ç›®
2. å³é”®ç‚¹å‡»é¡¹ç›® â†’ **æ·»åŠ ** â†’ **ç°æœ‰é¡¹**
3. é€‰æ‹©å¯¹åº”çš„ `.cs` æ–‡ä»¶
4. ç‚¹å‡» **æ·»åŠ **

### æ­¥éª¤5ï¼šæ·»åŠ  NuGet åŒ…å¼•ç”¨

#### 5.1 ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹åŒ…

æ‰“å¼€ NuGet åŒ…ç®¡ç†å™¨æ§åˆ¶å°ï¼Œè¿è¡Œï¼š

```powershell
# MVVM Toolkitï¼ˆå·²å­˜åœ¨ï¼Œç¡®è®¤ç‰ˆæœ¬ï¼‰
Install-Package CommunityToolkit.Mvvm -Version 8.2.0

# Microsoft.Xaml.Behaviors.Wpfï¼ˆå¿…éœ€ï¼Œç”¨äºBehaviorï¼‰
Install-Package Microsoft.Xaml.Behaviors.Wpf -Version 1.1.39
```

#### 5.2 éªŒè¯åŒ…å¼•ç”¨

åœ¨ `.csproj` æ–‡ä»¶ä¸­ç¡®è®¤æœ‰ä»¥ä¸‹ `<PackageReference>`ï¼š

```xml
<PackageReference Include="CommunityToolkit.Mvvm" Version="8.2.0" />
<PackageReference Include="Microsoft.Xaml.Behaviors.Wpf" Version="1.1.39" />
```

### æ­¥éª¤6ï¼šæ›´æ–°å‘½åç©ºé—´å¼•ç”¨

#### 6.1 åœ¨ `LayoutMetadata.cs` ä¸­æ·»åŠ å¼•ç”¨

åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ï¼š

```csharp
using Demo_ReportPrinter.Constants;
```

#### 6.2 åœ¨ `TemplateEditorViewModel.cs` ä¸­æ·»åŠ å¼•ç”¨

åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ï¼š

```csharp
using Demo_ReportPrinter.Constants;
using Demo_ReportPrinter.Helpers;
```

#### 6.3 åœ¨ `TemplateEditorPanel.xaml.cs` ä¸­æ·»åŠ å¼•ç”¨

ç¡®ä¿å·²æœ‰ä»¥ä¸‹å¼•ç”¨ï¼š

```csharp
using Demo_ReportPrinter.Models.CoreEntities;
using Demo_ReportPrinter.Helpers;
using Demo_ReportPrinter.ViewModels;
using Demo_ReportPrinter.Constants;
using Demo_ReportPrinter.Behaviors;
```

---

## å››ã€ç¼–è¯‘é…ç½®

### 4.1 æ¸…ç†é¡¹ç›®

```bash
dotnet clean
```

æˆ–ä½¿ç”¨ Visual Studioï¼š**ç”Ÿæˆ** â†’ **æ¸…ç†è§£å†³æ–¹æ¡ˆ**

### 4.2 é‡æ–°ç”Ÿæˆé¡¹ç›®

```bash
dotnet build
```

æˆ–ä½¿ç”¨ Visual Studioï¼š**ç”Ÿæˆ** â†’ **ç”Ÿæˆè§£å†³æ–¹æ¡ˆ**

### 4.3 éªŒè¯ç¼–è¯‘ç»“æœ

**é¢„æœŸç»“æœï¼š**
- âœ… ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯
- âœ… è­¦å‘Šå¯ä»¥å¿½ç•¥ï¼ˆå¦‚æœæœ‰ï¼‰

**å¸¸è§ç¼–è¯‘é”™è¯¯åŠè§£å†³ï¼š**

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| `æ‰¾ä¸åˆ°ç±»å‹æˆ–å‘½åç©ºé—´åç§° 'PaperSizeType'` | `PaperSizeConstants.cs` æœªæ­£ç¡®å¼•ç”¨ | æ£€æŸ¥å‘½åç©ºé—´å’Œæ–‡ä»¶ä½ç½® |
| `æ‰¾ä¸åˆ°ç±»å‹æˆ–å‘½åç©ºé—´åç§° 'CoordinateHelper'` | `CoordinateHelper.cs` æœªæ­£ç¡®å¼•ç”¨ | æ·»åŠ  `using Demo_ReportPrinter.Helpers;` |
| `æ‰¾ä¸åˆ°ç±»å‹æˆ–å‘½åç©ºé—´åç§° 'Behavior'` | ç¼ºå°‘ Microsoft.Xaml.Behaviors.Wpf | å®‰è£… NuGet åŒ… |
| `æ‰¾ä¸åˆ°ç±»å‹æˆ–å‘½åç©ºé—´åç§° 'Constants'` | `Constants.cs` å‘½åç©ºé—´é”™è¯¯ | ç¡®ä¿å‘½åç©ºé—´ä¸º `Demo_ReportPrinter.Constants` |

---

## äº”ã€æµ‹è¯•éªŒè¯

### 5.1 è¿è¡Œå•å…ƒæµ‹è¯•

```bash
dotnet test
```

æˆ–ä½¿ç”¨ Visual Studioï¼š**æµ‹è¯•** â†’ **è¿è¡Œæ‰€æœ‰æµ‹è¯•**

**é¢„æœŸæµ‹è¯•ç»“æœï¼š**

#### PaperSizeTests
- âœ… `Test_PaperSizeConstants_A4Dimensions`
- âœ… `Test_PaperSizeConstants_A5Dimensions`
- âœ… `Test_PaperSizeConstants_A3Dimensions`
- âœ… `Test_PaperSizeConstants_LetterDimensions`
- âœ… `Test_PaperSizeConstants_LegalDimensions`
- âœ… `Test_PaperSizeInfo_A4PortraitPixelDimensions`
- âœ… `Test_PaperSizeInfo_A4LandscapePixelDimensions`
- âœ… `Test_PaperSizeInfo_A5PortraitPixelDimensions`
- âœ… `Test_PaperSizeInfo_A5LandscapePixelDimensions`
- âœ… `Test_LayoutMetadata_A4Portrait`
- âœ… `Test_LayoutMetadata_A4Landscape`
- âœ… `Test_LayoutMetadata_A5Portrait`
- âœ… `Test_LayoutMetadata_A5Landscape`
- âœ… `Test_LayoutMetadata_ToggleLandscape`
- âœ… `Test_LayoutMetadata_CustomPaperSize`
- âœ… `Test_PaperSizeConstants_GetByType_A4`
- âœ… `Test_PaperSizeConstants_GetDisplayWidth_A4Portrait`
- âœ… `Test_PaperSizeConstants_GetDisplayWidth_A4Landscape`
- âœ… `Test_PaperSizeConstants_GetDisplayHeight_A5Portrait`
- âœ… `Test_PaperSizeConstants_GetDisplayHeight_A5Landscape`
- âœ… `Test_PaperSizeComparisonTable`

#### CoordinateHelperTests
- âœ… æ‰€æœ‰åŸºç¡€è½¬æ¢æµ‹è¯•
- âœ… æ‰€æœ‰ Point è½¬æ¢æµ‹è¯•
- âœ… æ‰€æœ‰ Size è½¬æ¢æµ‹è¯•
- âœ… æ‰€æœ‰ Rect è½¬æ¢æµ‹è¯•
- âœ… æ‰€æœ‰ç¼©æ”¾è½¬æ¢æµ‹è¯•
- âœ… æ‰€æœ‰ç½‘æ ¼å¯¹é½æµ‹è¯•
- âœ… æ‰€æœ‰è¾¹ç•Œæ£€æŸ¥æµ‹è¯•
- âœ… æ‰€æœ‰è·ç¦»è®¡ç®—æµ‹è¯•
- âœ… æ‰€æœ‰æ ¼å¼åŒ–è¾“å‡ºæµ‹è¯•

### 5.2 æ‰‹åŠ¨åŠŸèƒ½éªŒè¯

#### 5.2.1 éªŒè¯çº¸å¼ è§„æ ¼åŠŸèƒ½

1. **å¯åŠ¨åº”ç”¨ç¨‹åº**
2. **æ‰“å¼€æ¨¡æ¿ç¼–è¾‘å™¨**
3. **é€‰æ‹©çº¸å¼ ç±»å‹**ï¼š
   - é€‰æ‹© A4 â†’ éªŒè¯ç”»å¸ƒå°ºå¯¸ä¸º 793Ã—1122px
   - é€‰æ‹© A5 â†’ éªŒè¯ç”»å¸ƒå°ºå¯¸ä¸º 559Ã—793px
   - åˆ‡æ¢æ¨ªå‘ â†’ éªŒè¯å®½é«˜äº’æ¢
4. **æŸ¥çœ‹çŠ¶æ€æ **ï¼šç¡®è®¤çº¸å¼ å°ºå¯¸æ˜¾ç¤ºæ­£ç¡®

#### 5.2.2 éªŒè¯æ‹–æ‹½åŠŸèƒ½

1. **æ·»åŠ æ–‡æœ¬æ¡†å…ƒç´ **
2. **é¼ æ ‡å·¦é”®æŒ‰ä½å…ƒç´ **
3. **æ‹–åŠ¨é¼ æ ‡** â†’ å…ƒç´ åº”è·Ÿéšé¼ æ ‡ç§»åŠ¨
4. **é‡Šæ”¾é¼ æ ‡** â†’ å…ƒç´ åº”åœæ­¢åœ¨å½“å‰ä½ç½®
5. **éªŒè¯ç½‘æ ¼å¯¹é½** â†’ å…ƒç´ åº”è‡ªåŠ¨å¯¹é½åˆ°ç½‘æ ¼ç‚¹ï¼ˆ10pxï¼‰

#### 5.2.3 éªŒè¯è°ƒæ•´å¤§å°åŠŸèƒ½

1. **é€‰ä¸­å…ƒç´ **
2. **é¼ æ ‡ç§»åŠ¨åˆ°å…ƒç´ è¾¹ç¼˜**
3. **é¼ æ ‡å˜ä¸ºè°ƒæ•´å¤§å°å…‰æ ‡**
4. **æ‹–æ‹½è°ƒæ•´å¤§å°** â†’ å…ƒç´ å°ºå¯¸åº”å®æ—¶å˜åŒ–
5. **éªŒè¯æœ€å°å°ºå¯¸é™åˆ¶** â†’ ä¸èƒ½å°äº 20Ã—20px

#### 5.2.4 éªŒè¯å¸é™„å¯¹é½åŠŸèƒ½

1. **æ·»åŠ å¤šä¸ªå…ƒç´ **
2. **æ‹–åŠ¨ä¸€ä¸ªå…ƒç´ é è¿‘å¦ä¸€ä¸ªå…ƒç´ **
3. **è§‚å¯Ÿè“è‰²è™šçº¿** â†’ å‡ºç°å¸é™„è¾…åŠ©çº¿
4. **å…ƒç´ è‡ªåŠ¨å¯¹é½** â†’ è¾¹ç¼˜/ä¸­å¿ƒè‡ªåŠ¨å¯¹é½

#### 5.2.5 éªŒè¯åæ ‡è½¬æ¢åŠŸèƒ½

1. **æ·»åŠ å…ƒç´ **
2. **è®¾ç½®ä½ç½®ä¸º (50, 100) mm**
3. **æŸ¥çœ‹ç”»å¸ƒä¸Šçš„å®é™…åƒç´ ä½ç½®** â†’ åº”ä¸º (189, 378)px
4. **åˆ‡æ¢ç¼©æ”¾æ¯”ä¾‹** â†’ æ˜¾ç¤ºåæ ‡åº”ç›¸åº”å˜åŒ–

---

## å…­ã€å¸¸è§é—®é¢˜è§£å†³

### 6.1 ç¼–è¯‘é”™è¯¯

#### é—®é¢˜ï¼šæ‰¾ä¸åˆ°å‘½åç©ºé—´ 'PaperSizeConstants'

**åŸå› ï¼š** æ–‡ä»¶æœªæ­£ç¡®æ·»åŠ åˆ°é¡¹ç›®æˆ–å‘½åç©ºé—´é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åœ¨æ­£ç¡®çš„ç›®å½•ï¼š`Models/CoreEntities/PaperSizeConstants.cs`
2. æ£€æŸ¥æ–‡ä»¶é¡¶éƒ¨çš„å‘½åç©ºé—´ï¼š
   ```csharp
   namespace Demo_ReportPrinter.Models.CoreEntities
   ```
3. åœ¨ `.csproj` æ–‡ä»¶ä¸­ç¡®è®¤æœ‰ `<Compile Include="..."/>`
4. é‡æ–°ç”Ÿæˆé¡¹ç›®

#### é—®é¢˜ï¼šæ‰¾ä¸åˆ°ç±»å‹æˆ–å‘½åç©ºé—´åç§° 'Behavior'

**åŸå› ï¼š** ç¼ºå°‘ Microsoft.Xaml.Behaviors.Wpf åŒ…

**è§£å†³æ–¹æ¡ˆï¼š**
```powershell
Install-Package Microsoft.Xaml.Behaviors.Wpf -Version 1.1.39
```

### 6.2 è¿è¡Œæ—¶é”™è¯¯

#### é—®é¢˜ï¼šæ‹–æ‹½åŠŸèƒ½ä¸ç”Ÿæ•ˆ

**åŸå› ï¼š** Behavior æœªæ­£ç¡®ç»‘å®š

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ XAML ä¸­æ˜¯å¦æ­£ç¡®å¼•ç”¨äº†å‘½åç©ºé—´ï¼š
   ```xml
   xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
   xmlns:behaviors="clr-namespace:Demo_ReportPrinter.Behaviors"
   ```
2. æ£€æŸ¥ Behavior æ˜¯å¦æ­£ç¡®é™„åŠ åˆ°å…ƒç´ ï¼š
   ```xml
   <i:Interaction.Behaviors>
       <behaviors:DragBehavior Element="{Binding}" IsDragEnabled="True"/>
   </i:Interaction.Behaviors>
   ```

#### é—®é¢˜ï¼šåæ ‡è½¬æ¢ä¸å‡†ç¡®

**åŸå› ï¼š** DPI è®¾ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤ä½¿ç”¨çš„æ˜¯ 96 DPI
2. æ£€æŸ¥ `Constants.Constants.Display.ScreenDPI` å€¼
3. ä½¿ç”¨ `CoordinateHelper.LogicalToScreen96()` æ–¹æ³•

### 6.3 åŠŸèƒ½é—®é¢˜

#### é—®é¢˜ï¼šA5æ¨ªå‘å°ºå¯¸ä¸æ­£ç¡®

**åŸå› ï¼š** æ¨ªå‘/çºµå‘åˆ‡æ¢é€»è¾‘é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ `LayoutMetadata` çš„ `ActualWidth` å’Œ `ActualHeight` å±æ€§ï¼š
   ```csharp
   public double ActualWidth => IsLandscape ? PaperHeight : PaperWidth;
   public double ActualHeight => IsLandscape ? PaperWidth : PaperHeight;
   ```
2. ç¡®è®¤ `ToggleLandscape` æ–¹æ³•æ­£ç¡®å®ç°
3. éªŒè¯ A5 æ¨ªå‘åº”ä¸º 210Ã—148mmï¼ˆ793.7Ã—559.2pxï¼‰

#### é—®é¢˜ï¼šç½‘æ ¼å¯¹é½ä¸ç”Ÿæ•ˆ

**åŸå› ï¼š** ç½‘æ ¼å¯¹é½æœªå¯ç”¨æˆ–ç½‘æ ¼å¤§å°è®¾ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ `Constants.Constants.DragDrop.EnableSnapToGrid` å€¼
2. æ£€æŸ¥ `Constants.Constants.DragDrop.GridSize` å€¼ï¼ˆé»˜è®¤ä¸º 10pxï¼‰
3. åœ¨ `DragBehavior` ä¸­ç¡®è®¤è°ƒç”¨äº† `SnapToGrid()` æ–¹æ³•

---

## ä¸ƒã€åç»­ä¼˜åŒ–å»ºè®®

### 7.1 æ€§èƒ½ä¼˜åŒ–

1. **è™šæ‹ŸåŒ–**ï¼šå¯¹äºå¤§é‡å…ƒç´ ï¼Œå¯ç”¨è™šæ‹ŸåŒ–
2. **å»¶è¿ŸåŠ è½½**ï¼šå»¶è¿ŸåŠ è½½éæ ¸å¿ƒåŠŸèƒ½
3. **ç¼“å­˜**ï¼šç¼“å­˜åæ ‡è½¬æ¢ç»“æœ

### 7.2 åŠŸèƒ½æ‰©å±•

1. **å¤šé€‰åŠŸèƒ½**ï¼šæ”¯æŒæ¡†é€‰å¤šä¸ªå…ƒç´ 
2. **å¯¹é½å·¥å…·**ï¼šæä¾›å·¦å¯¹é½ã€å³å¯¹é½ã€å±…ä¸­ç­‰å·¥å…·
3. **åˆ†ç»„åŠŸèƒ½**ï¼šæ”¯æŒå…ƒç´ çš„åˆ†ç»„å’Œè§£ç»„
4. **æ’¤é”€/é‡åš**ï¼šå®Œå–„æ’¤é”€/é‡åšåŠŸèƒ½

### 7.3 ç”¨æˆ·ä½“éªŒ

1. **å¿«æ·é”®**ï¼šæ·»åŠ æ›´å¤šå¿«æ·é”®æ”¯æŒ
2. **å·¥å…·æç¤º**ï¼šæ·»åŠ æ“ä½œæç¤ºå’Œå¸®åŠ©ä¿¡æ¯
3. **ä¸»é¢˜æ”¯æŒ**ï¼šæ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢

---

## å…«ã€æ€»ç»“

### 8.1 æ•´åˆå®Œæˆæ£€æŸ¥æ¸…å•

- [ ] æ‰€æœ‰æ–°æ–‡ä»¶å·²å¤åˆ¶åˆ°æ­£ç¡®ç›®å½•
- [ ] é¡¹ç›®æ–‡ä»¶å·²æ›´æ–°ï¼ˆ.csprojï¼‰
- [ ] å‘½åç©ºé—´å¼•ç”¨æ­£ç¡®
- [ ] NuGet åŒ…å·²å®‰è£…
- [ ] é¡¹ç›®ç¼–è¯‘æˆåŠŸ
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æ‰‹åŠ¨åŠŸèƒ½éªŒè¯é€šè¿‡
- [ ] æ–‡æ¡£å·²æ›´æ–°

### 8.2 éªŒè¯æ ‡å‡†

| éªŒè¯é¡¹ | æ ‡å‡† | ç»“æœ |
|--------|------|------|
| ç¼–è¯‘ | æ— é”™è¯¯ã€0è­¦å‘Š | â¬œ |
| å•å…ƒæµ‹è¯• | æ‰€æœ‰æµ‹è¯•é€šè¿‡ | â¬œ |
| çº¸å¼ è§„æ ¼ | A5æ¨ªå‘å°ºå¯¸ä¸º 210Ã—148mm | â¬œ |
| æ‹–æ‹½åŠŸèƒ½ | å…ƒç´ å¯è‡ªç”±æ‹–æ‹½ | â¬œ |
| è°ƒæ•´å¤§å° | å…ƒç´ å¯è°ƒæ•´å¤§å° | â¬œ |
| å¸é™„å¯¹é½ | å…ƒç´ è‡ªåŠ¨å¯¹é½ | â¬œ |
| åæ ‡è½¬æ¢ | æ¯«ç±³/åƒç´ è½¬æ¢å‡†ç¡® | â¬œ |

### 8.3 ä¸‹ä¸€æ­¥å·¥ä½œ

1. âœ… **å®Œæˆæ ¸å¿ƒåŠŸèƒ½æ•´åˆ**ï¼ˆå·²å®Œæˆï¼‰
2. â³ **è¿è¡Œæµ‹è¯•éªŒè¯**ï¼ˆå¾…æ‰§è¡Œï¼‰
3. â³ **ä¿®å¤å‘ç°çš„é—®é¢˜**ï¼ˆå¾…æ‰§è¡Œï¼‰
4. â³ **æ€§èƒ½ä¼˜åŒ–**ï¼ˆå¾…æ‰§è¡Œï¼‰
5. â³ **åŠŸèƒ½æ‰©å±•**ï¼ˆå¾…æ‰§è¡Œï¼‰

---

**æ–‡æ¡£ç»“æŸ**
